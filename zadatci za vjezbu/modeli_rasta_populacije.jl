using DifferentialEquations
using Plots

##linearni rast
linearni_rast = function(du, u, p, t) #du oznacava derivaciju, u početnu vrijednost populacije, p daje parametre a t vrijeme u kojem se provodi
    c = p
    du[1] = c
end

c = ((7794798739 - 2525149000) / (2100 - 1950)) / 1e9
u0 = [2525149000 / 1e9]
tspan = (1950.0, 2020.0)
linearni_problem = ODEProblem(linearni_rast, u0, tspan, c)
linearni_sol = solve(linearni_problem)
gr()
plot(linearni_sol, ylabel = "Milijarde", xlabel = "Godine", title = "Rast populacije", label = "Linearni rast", legend=:bottomright)

##eksponencijalni rast
eksponencijalni_rast = function(du, u, p, t) 
    alfa = p
    du[1] = alfa * u[1]
end

alfa = 0.018
eksponencijalni_problem = ODEProblem(eksponencijalni_rast, u0, tspan, alfa)
eksponencijalni_sol = solve(eksponencijalni_problem)
plot!(eksponencijalni_sol, label = "Eksponencijalni rast")

##logisticki rast
logisticki_rast = function(du, u, p, t) 
    alfa, K = p
    du[1] = u[1] * alfa * (1 - u[1] / K)
end

alfa = 0.025
beta = -0.0018
K = -(alfa / beta)
p = (alfa, K)
logisticki_problem = ODEProblem(logisticki_rast, u0, tspan, p)
logisticki_sol = solve(logisticki_problem)
plot!(logisticki_sol, label = "Logisticki rast")

##UN-ovi podatci
godine = [
    1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,
    1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,
    1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,
    2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024,2025,2026,2027,2028,2029,2030,2031,2032,2033,
    2034,2035,2036,2037,2038,2039,2040,2041,2042,2043,2044,2045,2046,2047,2048,2049,2050,2051,2052,2053,2054,
    2055,2056,2057,2058,2059,2060,2061,2062,2063,2064,2065,2066,2067,2068,2069,2070,2071,2072,2073,2074,2075,
    2076,2077,2078,2079,2080,2081,2082,2083,2084,2085,2086,2087,2088,2089,2090,2091,2092,2093,2094,2095,2096,
    2097,2098,2099,2100
]
broj = [
    2.525149,2.572850917,2.619292068,2.665865392,2.713172027,2.761650981,2.811572031,2.863042795,2.916030167,
    2.970395814,3.026002942,3.082830266,3.141071531,3.201178277,3.263738832,3.329122479,3.397475247,3.468521724,
    3.541674891,3.616108749,3.691172616,3.766754345,3.842873611,3.919182332,3.995304922,4.071020434,4.14613585,
    4.220816737,4.295664825,4.371527871,4.449048798,4.528234634,4.608962418,4.69155984,4.776392828,4.863601517,
    4.95337671,5.045315871,5.138214688,5.23,5.320816667,5.408908724,5.49489957,5.578865109,5.661086346,5.741822412,
    5.82101675,5.898688337,5.975303657,6.05147801,6.127700428,6.204147026,6.280853817,6.357991749,6.435705595,
    6.514094605,6.593227977,6.673105937,6.753649228,6.834721933,6.916183482,6.99799876,7.080072417,7.162119434,
    7.243784,7.349472,7.464022049,7.547858925,7.63109104,7.7134681,7.794798739,7.874965732,7.953952577,8.031800338,
    8.108605255,8.184437453,8.259276651,8.333078318,8.405863301,8.477660723,8.548487371,8.618349454,8.687227873,
    8.755083512,8.821862705,8.887524229,8.952048885,9.015437616,9.077693645,9.138828562,9.198847382,9.257745483,
    9.315508153,9.372118247,9.427555382,9.481803272,9.534854673,9.586707749,9.63735732,9.686800146,9.7350339,
    9.782061758,9.827885441,9.872501562,9.915905251,9.958098746,9.999085167,10.038881262,10.07751808,10.11503636,
    10.151469683,10.186837209,10.22114904,10.254419004,10.286658354,10.317879315,10.348098079,10.37733083,10.405590532,
    10.432889136,10.459239501,10.484654858,10.509150402,10.532742861,10.555450003,10.577288195,10.598274172,10.618420909,
    10.637736819,10.656228233,10.673904454,10.690773335,10.706852426,10.722171375,10.736765444,10.750662353,10.763874023,
    10.776402019,10.788248948,10.799413366,10.809892303,10.819682643,10.828780959,10.837182077,10.844878798,10.851860145,
    10.858111587,10.863614776,10.868347636,10.872284134,10.875393719
]

#usporedba modela logistickog rasta s UN-ovom projekcijom
plot(godine, broj, title = "Projekcija populacije do 2100", label = "UN-ova projekcija", legend = :bottomright, xlab = "Godine", ylab = "Milijarde")

alfa = 0.02487
beta = -0.001931
K = -(alfa / beta)
p = (alfa, K)
tspan = (1950.0, 2100.0)
logisticki_problem_UN = ODEProblem(logisticki_rast, u0, tspan, p)
logisticki_sol_UN = solve(logisticki_problem_UN)
plot!(logisticki_sol_UN, label = "Logisticki rast")

#= Najblize što sam uspio doci do UN-ove projekcije je za alfa = 0.02487, beta = -0.001931 =#